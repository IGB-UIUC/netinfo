language: php

branches:
    only:
    - master

services: 
    - mysql
php:
    - 7.2
    - 7.3

before_install:
    - echo "extension=snmp.so" >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini
    - echo "extension=pdo_mysql.so" >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini
    - echo "extension=ldap.so" >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini

    - mysql -e 'CREATE DATABASE netinfo CHARACTER SET utf8;'
    - mysql -u root --password="" netinfo < sql/netinfo.sql

install:
    - composer install --no-interaction

script:
    - if find . -name "*.php" ! -path "./vendor/*" -exec php -l {} 2>&1 \; | grep "syntax error, unexpected"; then exit 1; fi

